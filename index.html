<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Welcome to lrtree’s documentation! &mdash; lrtree 1.0.4 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="lrtree" href="_autosummary/lrtree.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="#" class="icon icon-home"> lrtree
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="_autosummary/lrtree.html">lrtree</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">lrtree</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">Welcome to <code class="xref py py-mod docutils literal notranslate"><span class="pre">lrtree</span></code>’s documentation!</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="toctree-wrapper compound">
</div>
<section id="welcome-to-lrtree-s-documentation">
<h1>Welcome to <a class="reference internal" href="_autosummary/lrtree.html#module-lrtree" title="lrtree"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lrtree</span></code></a>’s documentation!<a class="headerlink" href="#welcome-to-lrtree-s-documentation" title="Permalink to this heading"></a></h1>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_autosummary/lrtree.html#module-lrtree" title="lrtree"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lrtree</span></code></a></p></td>
<td><p>This module is dedicated to logistic regression trees</p></td>
</tr>
</tbody>
</table>
<div class="toctree-wrapper compound">
</div>
<p><a class="reference external" href="https://badge.fury.io/py/lrtree"><img alt="PyPI version" src="https://badge.fury.io/py/lrtree.svg" /></a>
<a class="reference external" href="https://pypi.python.org/pypi/lrtree/"><img alt="PyPI pyversions" src="https://img.shields.io/pypi/pyversions/lrtree.svg" /></a>
<a class="reference external" href="https://img.shields.io/pypi/dm/lrtree"><img alt="PyPi Downloads" src="https://img.shields.io/pypi/dm/lrtree" /></a>
<a class="reference external" href="https://app.travis-ci.com/adimajo/lrtree"><img alt="Build Status" src="https://app.travis-ci.com/adimajo/lrtree.svg?branch=master" /></a>
<img alt="Python package" src="https://github.com/adimajo/lrtree/workflows/Python%20package/badge.svg" />
<a class="reference external" href="https://codecov.io/gh/adimajo/lrtree"><img alt="codecov" src="https://codecov.io/gh/adimajo/lrtree/branch/master/graph/badge.svg" /></a></p>
<section id="logistic-regression-trees">
<h2>Logistic regression trees<a class="headerlink" href="#logistic-regression-trees" title="Permalink to this heading"></a></h2>
<section id="table-of-contents">
<h3>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://adimajo.github.io/lrtree">Documentation</a></p></li>
<li><p><span class="xref myst">Installation instructions</span></p></li>
<li><p><a class="reference external" href="https://adimajo.github.io/logistic_trees.html">Theory</a></p></li>
<li><p><span class="xref myst">Some examples</span></p></li>
<li><p><a class="reference external" href="https://github.com/adimajo/lrtree/issues/new/choose">Open an issue</a></p></li>
<li><p><span class="xref myst">References</span></p></li>
<li><p><span class="xref myst">Contribute</span></p></li>
</ul>
</section>
<section id="motivation">
<h3>Motivation<a class="headerlink" href="#motivation" title="Permalink to this heading"></a></h3>
<p>The goal of <code class="docutils literal notranslate"><span class="pre">lrtree</span></code> is to build decision trees with logistic regressions at their leaves, so that the resulting model mixes non parametric VS parametric and stepwise VS linear approaches to have the best predictive results, yet maintaining interpretability.</p>
<p>This is the implementation of glmtree as described in <em>Formalization and study of statistical problems in Credit Scoring</em>, Ehrhardt A. (see <a class="reference external" href="https://github.com/adimajo/manuscrit_these">manuscript</a> or <a class="reference external" href="https://adimajo.github.io/logistic_trees.html">web article</a>)</p>
</section>
<section id="getting-started">
<h3>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this heading"></a></h3>
<p>These instructions will get you a copy of the project up and running on your local machine for development and testing purposes.</p>
<section id="prerequisites">
<h4>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this heading"></a></h4>
<p>This code is supported on Python 3.8, 3.9, 3.10.</p>
</section>
<section id="installing-the-package">
<h4>Installing the package<a class="headerlink" href="#installing-the-package" title="Permalink to this heading"></a></h4>
<section id="installing-the-development-version">
<h5>Installing the development version<a class="headerlink" href="#installing-the-development-version" title="Permalink to this heading"></a></h5>
<p>If <code class="docutils literal notranslate"><span class="pre">git</span></code> is installed on your machine, you can use:</p>
<div class="highlight-PowerShell notranslate"><div class="highlight"><pre><span></span><span class="n">pipenv</span> <span class="n">install</span> <span class="n">git</span><span class="p">+</span><span class="n">https</span><span class="p">://</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="p">/</span><span class="n">adimajo</span><span class="p">/</span><span class="n">lrtree</span><span class="p">.</span><span class="n">git</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">git</span></code> is not installed, you can also use:</p>
<div class="highlight-PowerShell notranslate"><div class="highlight"><pre><span></span><span class="n">pipenv</span> <span class="n">install</span> <span class="p">-</span><span class="n">-upgrade</span> <span class="n">https</span><span class="p">://</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="p">/</span><span class="n">adimajo</span><span class="p">/</span><span class="n">lrtree</span><span class="p">/</span><span class="n">archive</span><span class="p">/</span><span class="n">master</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span>
</pre></div>
</div>
</section>
<section id="installing-through-the-pip-command">
<h5>Installing through the <code class="docutils literal notranslate"><span class="pre">pip</span></code> command<a class="headerlink" href="#installing-through-the-pip-command" title="Permalink to this heading"></a></h5>
<p>You can install a stable version from <a class="reference external" href="https://pypi.org/project/lrtree/">PyPi</a> by using:</p>
<div class="highlight-PowerShell notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">lrtree</span>
</pre></div>
</div>
<p>To run the provided scripts, <code class="docutils literal notranslate"><span class="pre">lrtree-consistency</span></code> and <code class="docutils literal notranslate"><span class="pre">lrtree-realdata</span></code>, you need a
few additional dependencies:</p>
<div class="highlight-PowerShell notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">lrtree</span><span class="no">[scripts]</span>
</pre></div>
</div>
</section>
<section id="installation-guide-for-anaconda">
<h5>Installation guide for Anaconda<a class="headerlink" href="#installation-guide-for-anaconda" title="Permalink to this heading"></a></h5>
<p>The installation with the <code class="docutils literal notranslate"><span class="pre">pip</span></code> or <code class="docutils literal notranslate"><span class="pre">pipenv</span></code> command <strong>should</strong> work. If not, please raise an issue.</p>
</section>
<section id="for-people-behind-proxy-ies">
<h5>For people behind proxy(ies)…<a class="headerlink" href="#for-people-behind-proxy-ies" title="Permalink to this heading"></a></h5>
<p>A lot of people, including myself, work behind a proxy at work…</p>
<p>A simple solution to get the package is to use the <code class="docutils literal notranslate"><span class="pre">--proxy</span></code> option of <code class="docutils literal notranslate"><span class="pre">pip</span></code>:</p>
<div class="highlight-PowerShell notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="p">-</span><span class="n">-proxy</span><span class="p">=</span><span class="n">http</span><span class="p">://</span><span class="n">username</span><span class="p">:</span><span class="n">password</span><span class="nv">@server</span><span class="p">:</span><span class="n">port</span> <span class="n">install</span> <span class="n">lrtree</span>
</pre></div>
</div>
<p>where <em>username</em>, <em>password</em>, <em>server</em> and <em>port</em> should be replaced by your own values.</p>
<p>If environment variables <code class="docutils literal notranslate"><span class="pre">http_proxy</span></code> and / or <code class="docutils literal notranslate"><span class="pre">https_proxy</span></code> and / or (unfortunately depending on applications…)
<code class="docutils literal notranslate"><span class="pre">HTTP_PROXY</span></code> and <code class="docutils literal notranslate"><span class="pre">HTTPS_PROXY</span></code> are set, the proxy settings should be picked up by <code class="docutils literal notranslate"><span class="pre">pip</span></code>.</p>
<p>Over the years, I’ve found <a class="reference external" href="http://cntlm.sourceforge.net/">CNTLM</a> to be a great tool in this regard.</p>
</section>
</section>
</section>
<section id="authors">
<h3>Authors<a class="headerlink" href="#authors" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://adimajo.github.io">Adrien Ehrhardt</a></p></li>
<li><p><a class="reference external" href="https://sites.google.com/site/vvandewa/">Vincent Vandewalle</a></p></li>
<li><p><a class="reference external" href="http://math.univ-lille1.fr/~heinrich/">Philippe Heinrich</a></p></li>
<li><p><a class="reference external" href="http://math.univ-lille1.fr/~biernack/">Christophe Biernacki</a></p></li>
<li><p>Dmitri Gaynullin</p></li>
<li><p>Elise Bayraktar</p></li>
</ul>
</section>
<section id="license">
<h3>License<a class="headerlink" href="#license" title="Permalink to this heading"></a></h3>
<p>This project is licensed under the MIT License - see the <span class="xref myst">LICENSE</span> file for details.</p>
</section>
<section id="acknowledgments">
<h3>Acknowledgments<a class="headerlink" href="#acknowledgments" title="Permalink to this heading"></a></h3>
<p>This research has been financed by <a class="reference external" href="https://www.ca-consumerfinance.com/en.html">Crédit Agricole Consumer Finance</a> through a CIFRE PhD.</p>
<p>This research was supported by <a class="reference external" href="https://www.inria.fr/centre/lille">Inria Lille - Nord-Europe</a> and <a class="reference external" href="https://www.univ-lille.fr/en/home/">Lille University</a> as part of a PhD.</p>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Permalink to this heading"></a></h3>
<p>Ehrhardt, A. (2019), <a class="reference external" href="https://hal.archives-ouvertes.fr/tel-02302691">Formalization and study of statistical problems in Credit Scoring: Reject inference, discretization and pairwise interactions, logistic regression trees</a> (<a class="reference external" href="https://github.com/adimajo/manuscrit_these">PhD thesis</a>).</p>
</section>
<section id="contribute">
<h3>Contribute<a class="headerlink" href="#contribute" title="Permalink to this heading"></a></h3>
<p>You can clone this project using:</p>
<div class="highlight-PowerShell notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">://</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="p">/</span><span class="n">adimajo</span><span class="p">/</span><span class="n">lrtree</span><span class="p">.</span><span class="n">git</span>
</pre></div>
</div>
<p>You can install all dependencies, including development dependencies, using (note that
this command requires <code class="docutils literal notranslate"><span class="pre">pipenv</span></code> which can be installed by typing <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">pipenv</span></code>):</p>
<div class="highlight-PowerShell notranslate"><div class="highlight"><pre><span></span><span class="n">pipenv</span> <span class="n">install</span> <span class="n">-d</span>
</pre></div>
</div>
<p>You can build the documentation by going into the <code class="docutils literal notranslate"><span class="pre">docs</span></code> directory and typing <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">html</span></code>.</p>
<p>You can run the tests by typing <code class="docutils literal notranslate"><span class="pre">coverage</span> <span class="pre">run</span> <span class="pre">-m</span> <span class="pre">pytest</span></code>, which relies on packages
<a class="reference external" href="https://coverage.readthedocs.io/en/coverage-5.2/">coverage</a> and <a class="reference external" href="https://docs.pytest.org/en/latest/">pytest</a>.</p>
<p>To run the tests in different environments (one for each version of Python), install <code class="docutils literal notranslate"><span class="pre">pyenv</span></code> (see <a class="reference external" href="https://github.com/pyenv/pyenv">the instructions here</a>),
install all versions you want to test (see <span class="xref myst">tox.ini</span>), e.g. with <code class="docutils literal notranslate"><span class="pre">pyenv</span> <span class="pre">install</span> <span class="pre">3.7.0</span></code> and run
<code class="docutils literal notranslate"><span class="pre">pipenv</span> <span class="pre">run</span> <span class="pre">pyenv</span> <span class="pre">local</span> <span class="pre">3.7.0</span> <span class="pre">[...]</span></code> (and all other versions) followed by <code class="docutils literal notranslate"><span class="pre">pipenv</span> <span class="pre">run</span> <span class="pre">tox</span></code>.</p>
</section>
<section id="python-environment">
<h3>Python Environment<a class="headerlink" href="#python-environment" title="Permalink to this heading"></a></h3>
<p>The project uses <code class="docutils literal notranslate"><span class="pre">pipenv</span></code>. <a class="reference external" href="https://realpython.com/pipenv-guide/">An interesting resource</a>.</p>
<p>To download all the project dependencies in order to then port them to a machine that had limited access to the internet, you must use the command
<code class="docutils literal notranslate"><span class="pre">pipenv</span> <span class="pre">lock</span> <span class="pre">-r</span> <span class="pre">&gt;</span> <span class="pre">requirements.txt</span></code> which will transform the <code class="docutils literal notranslate"><span class="pre">Pipfile</span></code> into a <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code>.</p>
</section>
<section id="installation">
<h3>Installation<a class="headerlink" href="#installation" title="Permalink to this heading"></a></h3>
<p>To install a virtual environment as well as all the necessary dependencies, you must use the <code class="docutils literal notranslate"><span class="pre">pipenv</span> <span class="pre">install</span></code> command for production use
or the command <code class="docutils literal notranslate"><span class="pre">pipenv</span> <span class="pre">install</span> <span class="pre">-d</span></code> for development use.</p>
</section>
<section id="tests">
<h3>Tests<a class="headerlink" href="#tests" title="Permalink to this heading"></a></h3>
<p>The tests are based on <code class="docutils literal notranslate"><span class="pre">pytest</span></code> and are stored in the <code class="docutils literal notranslate"><span class="pre">tests</span></code> folder. They can all be launched with the command
<code class="docutils literal notranslate"><span class="pre">pytest</span></code> in at the root of the project.
The test coverage can be calculated thanks to the <code class="docutils literal notranslate"><span class="pre">coverage</span></code> package, which is also responsible for launching the tests.
The command to use is <code class="docutils literal notranslate"><span class="pre">coverage</span> <span class="pre">run</span> <span class="pre">-m</span> <span class="pre">pytest</span></code>. We can then obtain a graphic summary in the form of an HTML page
using the <code class="docutils literal notranslate"><span class="pre">coverage</span> <span class="pre">html</span></code> command which creates or updates the <code class="docutils literal notranslate"><span class="pre">htmlcov</span></code> folder from which we can open the <code class="docutils literal notranslate"><span class="pre">index.html</span></code> file.</p>
</section>
<section id="utilization">
<h3>Utilization<a class="headerlink" href="#utilization" title="Permalink to this heading"></a></h3>
<p>The package provides <a class="reference external" href="https://scikit-learn.org/stable">sklearn-like</a> interface.</p>
<p>Loading <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_boston.html">sample data</a> for regression task:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_boston</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_boston</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
</pre></div>
</div>
<p>The trained model consists of a fitted <code class="docutils literal notranslate"><span class="pre">sklearn.tree.DecisionTreeClassifier</span></code> class for segmentation of a data and
<code class="docutils literal notranslate"><span class="pre">sklearn.linear_model.LogisticRegression</span></code> regressions for each node a of a tree in a form of python list.</p>
<p>The snippet to train the model and make a prediction:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lrtree</span> <span class="kn">import</span> <span class="n">Lrtree</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Lrtree</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span><span class="s2">&quot;bic&quot;</span><span class="p">,</span> <span class="n">ratios</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,),</span> <span class="n">class_num</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># Fitting the model</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Make a prediction on a fitted model</span>
<span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
<p>If you installed the additional dependencies for scripts, you can also run directly from the command line:</p>
<div class="highlight-PowerShell notranslate"><div class="highlight"><pre><span></span><span class="n">LOGURU_LEVEL</span><span class="p">=</span><span class="s2">&quot;ERROR&quot;</span> <span class="n">DEBUG</span><span class="p">=</span><span class="s2">&quot;True&quot;</span> <span class="n">lrtree-consistency</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-PowerShell notranslate"><div class="highlight"><pre><span></span><span class="n">LOGURU_LEVEL</span><span class="p">=</span><span class="s2">&quot;ERROR&quot;</span> <span class="n">TQDM_DISABLE</span><span class="p">=</span><span class="s2">&quot;1&quot;</span> <span class="n">lrtree-realdata</span>
</pre></div>
</div>
<p>Beware: if you don’t set <code class="docutils literal notranslate"><span class="pre">LOGURU_LEVEL</span></code> then it is implicitly set on DEBUG
which will yield a lot of prints. Also, both scripts will take very long
to complete as they test the consistency of the method for various
hyperparameters and run cross-validation on 3 real datasets respectively.</p>
</section>
</section>
</section>
<section id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this heading"></a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="_autosummary/lrtree.html" class="btn btn-neutral float-right" title="lrtree" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Adrien Ehrhardt, Dmitry Gaynullin, Elise Bayraktar.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>